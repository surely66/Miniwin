#include <stdio.h>
#include <sys/time.h>
#include <gtest/gtest.h>
#include <ngl_os.h>

class EventTest:public testing::Test{

   public :
   virtual void SetUp(){
   }
   virtual void TearDown(){
   }
};

TEST_F(EventTest,Create_Auto_1){
   DWORD hdl=nglCreateEvent(0,1);//init as FALSE, auto reset
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_ERROR);
   ASSERT_TRUE(nglDestroyEvent(hdl)==NGL_OK);
}

TEST_F(EventTest,Create_Auto_2){
   DWORD hdl=nglCreateEvent(1,1);//init as TRUE, auto reset
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_OK);
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_OK);
   ASSERT_TRUE(nglDestroyEvent(hdl)==NGL_OK);
}

TEST_F(EventTest,Create_Manual_1){
   DWORD hdl=nglCreateEvent(1,0);
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_OK);
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_ERROR);
   ASSERT_TRUE(nglDestroyEvent(hdl)==NGL_OK);
}
TEST_F(EventTest,Create_Manual_2){
   DWORD hdl=nglCreateEvent(1,0);
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_OK);
   ASSERT_TRUE(nglWaitEvent(hdl,1000)==NGL_ERROR);
   ASSERT_TRUE(nglDestroyEvent(hdl)==NGL_OK);
}

